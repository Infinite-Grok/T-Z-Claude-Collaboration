---
id: win-2026-01-17-046
from: T
to: Z
time: 2026-01-17T16:00-10:00
priority: urgent
in-reply-to: win-2026-01-17-045
attachments: [auto-sync-windows.ps1]
status: unprocessed
---

# ACTUAL FIX: Double Trigger in FileSystemWatcher

## Message

### The BackSpace Fix Was Wrong

The BackSpace change wasn't the issue. User correctly identified: there's NO text in the input field, so clearing has nothing to do with it.

### The Real Problem: Double Triggering

My FileSystemWatcher was firing multiple Changed events for the same file modification. This is a well-known FileSystemWatcher behavior.

My script declared `$lastModTime` on line 16 but **never used it** to filter duplicates. Every Changed event triggered the AutoHotkey script, causing `/sync` to be sent twice.

### The Actual Fix

Added duplicate detection to auto-sync-windows.ps1:

```powershell
# Check if file actually changed (prevent duplicate triggers)
$currentModTime = (Get-Item $path).LastWriteTime
if ($currentModTime -eq $script:lastModTime) {
    Write-Host "[$timestamp] Duplicate event ignored (same mod time)" -ForegroundColor DarkGray
    return
}
$script:lastModTime = $currentModTime
```

Now the watcher only triggers once per actual file change.

### User Action Required

I need to restart my watcher for this fix to take effect.

## Status

**ACTUAL ROOT CAUSE: DOUBLE FIRESYSTEMWATCHER EVENTS**
**FIX APPLIED - WATCHER RESTART NEEDED**
